---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "Resource hush_access_policy - terraform-provider-hush"
subcategory: ""
description: |-
  Access policy resource for managing Hush Security access policies
---

# Resource (hush_access_policy)

Access policy resource for managing Hush Security access policies

## Example Usage

```terraform
# Create an access policy for a PostgreSQL credential
resource "hush_access_policy" "postgres_example" {
  name                 = "prod-db-policy"
  description          = "Access policy for production database"
  enabled              = true
  access_credential_id = hush_postgres_access_credential.example.id
  access_privilege_ids = [hush_postgres_access_privilege.example.id]
  deployment_ids       = [hush_deployment.example.id]

  attestation_criteria {
    type  = "k8s:ns"
    value = "production"
  }

  attestation_criteria {
    type  = "k8s:sa"
    value = "app-service-account"
  }

  # Template: postgresql://${username}:${password}@${host}:${port}/${db}
  env_delivery_config {
    name = "DATABASE_URL"
    type = "template"
    key  = "postgresql://$${username}:$${password}@$${host}:$${port}/$${db}"
  }
}

# Create an access policy for a MongoDB credential
resource "hush_access_policy" "mongodb_example" {
  name                 = "prod-mongodb-policy"
  description          = "Access policy for production MongoDB"
  enabled              = true
  access_credential_id = hush_mongodb_access_credential.example.id
  deployment_ids       = [hush_deployment.example.id]

  attestation_criteria {
    type  = "k8s:ns"
    value = "production"
  }

  # Template: mongodb://${username}:${password}@${host}:${port}/${db_name}?authSource=${auth_source}
  env_delivery_config {
    name = "MONGODB_URI"
    type = "template"
    key  = "mongodb://$${username}:$${password}@$${host}:$${port}/$${db_name}?authSource=$${auth_source}"
  }
}

# Create an access policy for a MySQL credential
resource "hush_access_policy" "mysql_example" {
  name                 = "prod-mysql-policy"
  description          = "Access policy for production MySQL"
  enabled              = true
  access_credential_id = hush_mysql_access_credential.example.id
  access_privilege_ids = [hush_mysql_access_privilege.example.id]
  deployment_ids       = [hush_deployment.example.id]

  attestation_criteria {
    type  = "k8s:ns"
    value = "production"
  }

  # Template: mysql://${username}:${password}@${host}:${port}/${db_name}
  env_delivery_config {
    name = "MYSQL_URL"
    type = "template"
    key  = "mysql://$${username}:$${password}@$${host}:$${port}/$${db_name}"
  }
}

# Create an access policy for a MariaDB credential
resource "hush_access_policy" "mariadb_example" {
  name                 = "prod-mariadb-policy"
  description          = "Access policy for production MariaDB"
  enabled              = true
  access_credential_id = hush_mariadb_access_credential.example.id
  deployment_ids       = [hush_deployment.example.id]

  attestation_criteria {
    type  = "k8s:ns"
    value = "production"
  }

  # Template: mariadb://${username}:${password}@${host}:${port}/${db_name}
  env_delivery_config {
    name = "MARIADB_URL"
    type = "template"
    key  = "mariadb://$${username}:$${password}@$${host}:$${port}/$${db_name}"
  }
}

# Create an access policy for an OpenAI credential
resource "hush_access_policy" "openai_example" {
  name                 = "prod-openai-policy"
  description          = "Access policy for OpenAI API"
  enabled              = true
  access_credential_id = hush_openai_access_credential.example.id
  access_privilege_ids = [hush_openai_access_privilege.example.id]
  deployment_ids       = [hush_deployment.example.id]

  attestation_criteria {
    type  = "k8s:ns"
    value = "production"
  }

  env_delivery_config {
    name = "OPENAI_API_KEY"
    key  = "api_key"
  }
}

# Create an access policy for a Gemini credential
resource "hush_access_policy" "gemini_example" {
  name                 = "prod-gemini-policy"
  description          = "Access policy for Gemini API"
  enabled              = true
  access_credential_id = hush_gemini_access_credential.example.id
  deployment_ids       = [hush_deployment.example.id]

  attestation_criteria {
    type  = "k8s:ns"
    value = "production"
  }

  env_delivery_config {
    name = "GEMINI_SERVICE_ACCOUNT_KEY"
    key  = "service_account_key"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `access_credential_id` (String) The ID of the access credential
- `attestation_criteria` (Block List, Min: 1) The attestation criteria for the access policy (see [below for nested schema](#nestedblock--attestation_criteria))
- `deployment_ids` (List of String) The list of deployment IDs
- `env_delivery_config` (Block List, Min: 1) Environment variable delivery configuration for the access policy (see [below for nested schema](#nestedblock--env_delivery_config))
- `name` (String) The name of the access policy

### Optional

- `access_privilege_ids` (List of String) The list of access privilege IDs
- `description` (String) The description of the access policy
- `enabled` (Boolean) Whether the access policy is enabled

### Read-Only

- `id` (String) The ID of the access policy
- `status` (String) The status of the access policy (syncing, ok, warning, error, disabled)
- `status_detail` (String) The status detail of the access policy

<a id="nestedblock--attestation_criteria"></a>
### Nested Schema for `attestation_criteria`

Required:

- `type` (String) The type of attestation criterion (k8s:ns, k8s:sa, k8s:pod-label, k8s:pod-name, or k8s:container-name)
- `value` (String) The value of the attestation criterion

Optional:

- `key` (String) The key for label type criterion


<a id="nestedblock--env_delivery_config"></a>
### Nested Schema for `env_delivery_config`

Required:

- `name` (String) The environment variable name for the delivery item

Optional:

- `key` (String) The credential key or template string for the delivery item
- `type` (String) The type of delivery item mapping (key or template)
